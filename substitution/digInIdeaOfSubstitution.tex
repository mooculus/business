\documentclass{ximera}

\input{../preamble}


\title[Dig-In:]{The idea of substitution}
\begin{document}
\begin{abstract}
  We learn a new technique, called substitution, to help us solve
  problems involving integration.
\end{abstract}
\maketitle


Computing antiderivatives is not as easy as computing derivatives.
One issue is that the chain rule can be difficult to ``undo.''  We
have a general method called ``integration by substitution'' that will
somewhat help with this difficulty. The idea is this, we know from the
chain rule that
\[
\ddx f(g(x)) = f'(g(x))g'(x)
\]
so if we conisder
\begin{align*}
  \int_a^b f'(g(x))g'(x) \d x &= \eval{f(g(x))}_a^b \\
  &= f(g(b)) - f(g(a)) \\
  &= \eval{f(g)}_{g(a)}^{g(b)}\\
  &= \int_{g(a)}^{g(b)}f'(g) \d g.
\end{align*}

This ``transformation'' is worth stating explicity:

\begin{theorem}[Integral Substitution Formula]\index{integral substitution formula} 
If $g$ is differentiable on the interval $[a,b]$ and $f$ is
differentiable on the interval $[g(a),g(b)]$, then
\[
\int_a^b f'(g(x)) g'(x) \d x =\int_{g(a)}^{g(b)} f'(g) \d g.
\]
\end{theorem}

\section{Three similar techinques}

There are several different ways to think about substitution. The
first is directly using the formula
\[
\int_a^b f'(g(x)) g'(x) \d x = \int_{g(a)}^{g(b)} f'(g) \d g.
\]
\begin{example}
Compute:
\[
\int_1^3 x e^{x^{2}}\d x
\]
\begin{explanation}
A little thought reveals that if $x e^{x^{2}}$ is the derivative of
some function, then it must have come from an application of the chain
rule. 
\[
\int \underbrace{x}_{\text{derivative of inside}}\cos(\underbrace{x^2}_{\text{inside}})\d x.
\]
Set $g(x) = x^2$, so $g'(x) = 2x$, and now it must be that $f'(g) =
\frac{e^{g}}{2}$. Now we see
\begin{align*}
\int_1^3 x e^{x^{2}}\d x &= \int_1^9 \frac{e^{g}}{2}\d g\\
&= \eval{\frac{e^{g}}{2}}_1^9 \\
&= \frac{e^{9} -e^{1}}{2}.
\end{align*}
Notice the change of endpoints in the first equality!  
We obtained the new integrands by the computations
\begin{align*}
g(1) &= 1^2 = 1  \\
g(3) &= 3^2 = 9.
\end{align*}
\end{explanation}
\end{example}

We will usually solve these problems in a slightly different
way. Let's do the same example again, this time we will think in terms
of differentials.

\begin{example}\label{main example}
Compute:
\[
\int_1^3 x e^{x^{2}}\d x
\]
\begin{explanation}
Here we will set $g(x) = x^2$. Then $\d g = \answer[given]{2x} \d x$,
where we are thinking in terms of differentials. So we can solve for
$\d x$ to get $\d x = \frac{\d g}{\answer[given]{2x}}$.  We then see
that
\begin{align*}
  \int_1^3 x e^{x^{2}} \d x &= \int_{g(1)}^{g(3)} x e^{g} \frac{\d g}{2x}\\
  &= \int_{1}^{9} \frac{e^{g}}{2}\d g .
\end{align*}
At this point, we can continue as we did before and write
\[
\int_1^3 x e^{x^{2}}\d x= \frac{e^{9} -e^{1}}{2}.
\]
\end{explanation}
\end{example}

Finally, sometimes we simply want to deal with the antiderivative on
its own, we'll repeat the example one more time demonstrating this.

\begin{example}
Compute:
\[
\int_1^3 x e^{x^{2}}\d x
\]
\begin{explanation}
Here we start as we did before, setting $g(x)=x^2$. Now $\d g =  2x \d x$,
again thinking in terms of differentials. Now we see that
\[
\int x e^{x^{2}} \d x = \int x e^{g} \frac{\d g}{2x} = \int \frac{e^{g}}{2}\d g .
\]
Hence 
\[
\int x e^{x^{2}}\d x = \frac{e^{g}}{2} = \frac{e^{x^{2}}}{2}.
\]
So
\begin{align*}
\int_1^3 x e^{x^{2}}\d x &=\eval{\frac{e^{x^{2}}}{2}}_1^3\\
&= \frac{e^{9} -e^{1}}{2}.
\end{align*}
\end{explanation}
\end{example}

\section{More examples}

With some experience, it is (usually) not too hard to see what to
substitute as $g$.  We will work through the following examples in the
same way that we did for Example \ref{main example}. Let's see another
example.

\begin{example}
Compute:
\[
\int x^4(x^5+1)^{9} \d x
\]
\begin{explanation}
Here we set $g(x) =  \answer[given]{x^5+1}$, so $\d g =  \answer[given]{5x^4} \d x$.  Then
\begin{align*}
  \int x^4(x^5+1)^{9} \d x &= \frac{1}{5} \int 5x^4 (x^5+1)^{9} \d x \\
  &= \frac{1}{5} \int g^{9} \d g\\
&= \answer[given]{\frac{g^{10}}{50}}.
\end{align*}
Notice that this example is an indefinite integral and not a definite
integral, meaning that there are no limits of integration.  So we do
not need to worry about changing the endpoints of the integral.  However,
we do need to back-substitute into our answer, so that our final
answer is a function of $x$.  Recalling that $g(x) = x^5+1$, we have
our final answer
\[
\int x^4(x^5+1)^{9} \d x= \answer[given]{\frac{(x^5+1)^{10}}{50}}+C.
\]
\end{explanation}
\end{example}


If substitution works to solve an integral (and that is not always the
case!), a common trick to find what to substitute for is to locate the
``ugly'' part of the function being integrated.  We then substitute
for the ``inside'' of this ugly part.  While this technique is
certainly not rigorous, it can prove to be very helpful.  This is
especially true for students new to the technique of substitution.
The next two problems are really good examples of this philosophy.

\begin{example}
Compute:
\[
\int_{-1}^0 12x^3 e^{x^4} \d x
\]
\begin{explanation}
The ``ugly'' part of the function being integrated is $e^{x^4}$.  The
``inside'' of this term is then $x^4$.  So a good possibility is to
try
\[
g(x) =  \answer[given]{x^4}.
\]
Then
\[
\d g =  \answer[given]{4x^3} \d x 	\qquad	\Rightarrow	\qquad	\d x = \answer[given]{\frac{1}{4x^3}} \d g
\]
and so
\begin{align*}
\int_{-1}^0 12x^3 e^{x^4} \d x &= \int_{g(-1)}^{g(0)} 12 x^3 e^g \answer[given]{\frac{1}{4x^3}} \d g  \\
&= \int_{\answer[given]{1}}^{\answer[given]{0}} \answer[given]{3 e^g} \d g  \\
&= \eval{\answer[given]{3e^g}}_{\answer[given]{1}}^{\answer[given]{0}}  \\
&= \answer[given]{3(1-e)}.
\end{align*}
\end{explanation}
\end{example}




\begin{example}
  Compute:
  \[
  \int_{1}^{e^{2}} \frac{\sqrt{\ln x}}{x} \d x
  \]
\begin{explanation}
Here the ``ugly'' part here is $\sqrt{\ln x}$.  So we substitute for
the inside:
\[
g(x)=\answer[given]{\ln x}.
\]
Then
\[
\d g =  \answer[given]{\frac{1}{x}} \d x 	\qquad	\Rightarrow	\qquad	\d x = \answer[given]{x} \d g.
\]
Notice that
\begin{align*}
g(1) &= \ln (1) = \answer[given]{0} \\
g \left( e^{4} \right) &= \ln \left( e^{4} \right) = \answer[given]{4}.
\end{align*}
Then we substitute back into the original integral and solve:
\begin{align*}
\int_{1}^{e^{4}} \frac{\sqrt{\ln x}}{x} \d x &= \int_0^{4} \frac{\sqrt{g}}{x} x \d g  \\
&= \int_0^{4} \sqrt{g} \d g  \\
&= \eval{\answer[given]{\frac{2x^{3/2}}{3}}}_{0}^{4}  \\
&= \answer[given]{\frac{16}{3}} - \answer[given]{0} = \answer[given]{\frac{16}{3}}.
\end{align*}
\end{explanation}
\end{example}

To summarize, if we suspect that a given function is the derivative of
another via the chain rule, we let $g$ denote a likely candidate for
the inner function, then translate the given function so that it is
written entirely in terms of $g$, with no $x$ remaining in the
expression. If we can integrate this new function of $g$, then the
antiderivative of the original function is obtained by replacing $g$
by the equivalent expression in $x$.


\end{document}
