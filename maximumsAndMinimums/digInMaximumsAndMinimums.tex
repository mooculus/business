\documentclass{ximera}

\input{../preamble.tex}

\title[Dig-In]{Maximums and minimums}





\begin{document}
\begin{abstract}
We use derivatives to help locate extrema.  
\end{abstract}
\maketitle


Whether we are interested in a function as a purely mathematical
object or in connection with some application to the real world, it is
often useful to know what the graph of the function looks like. We can
obtain a good picture of the graph using certain crucial information
provided by derivatives of the function.

\section{Extrema}

Local \textit{extrema} on a function are points on the graph where the
$y$-coordinate is larger (or smaller) than all other $y$-coordinates
on the graph at points ``close to'' $(x,y)$. 

\begin{definition}\hfil\index{maximum/minimum!local}
\begin{enumerate}
\item A function $f$ has a \dfn{local maximum} at $x=a$, if $f(a)\ge
  f(x)$ for every $x$ near $a$.
\item A function $f$ has a \dfn{local minimum} at $x=a$, if $f(a)\le
  f(x)$ for every $x$ near $a$.
\end{enumerate}
A \dfn{local extremum}\index{extremum!local} is either a local
maximum or a local minimum.
\end{definition}

%% \begin{question} BADBAD I want this question
%%   True or false: ``All absolute extrema are also local extrema.''
%%   \begin{multipleChoice}
%%     \choice[correct]{true}
%%     \choice{false}
%%   \end{multipleChoice}
%%   \begin{feedback}
%%     All global extrema are local extrema.
%%   \end{feedback}
%% \end{question}

Local maximum and minimum points are quite distinctive on the graph of
a function, and are therefore useful in understanding the shape of the
graph. In many applied problems we want to find the largest or
smallest value that a function achieves (for example, we might want
to find the minimum cost at which some task can be performed) and so
identifying maximum and minimum points will be useful for applied
problems as well.



\section{Critical points}


If $(x,f(x))$ is a point where $f$ reaches a local maximum or minimum,
and if the derivative of $f$ exists at $x$, then the graph has a
tangent line and the tangent line must be horizontal. This is
important enough to state as a theorem, though we will not prove it.

\begin{theorem}[Fermat's Theorem]\index{Fermat's Theorem}\label{theorem:fermat}
If $f$ has a local extremum at $x=a$ and $f$ is differentiable
at $a$, then $f'(a)=0$.
\end{theorem}
\begin{question}
  Does Fermat's Theorem say that if $f'(a) = 0$, then $f$ has a local
  extrema at $x=a$?
  \begin{multipleChoice}
    \choice{yes}
    \choice[correct]{no}
  \end{multipleChoice}
  \begin{feedback}
    Consider $f(x) = x^3$, $f'(0) = 0$, but $f$ does not have a local
    maximum or minimum at $x=0$.
  \end{feedback}
\end{question}


Fermat's Theorem says that the only points at which a function can
have a local maximum or minimum are points at which the derivative is
zero, consider the plots of $f(x) = x^3-4x^2+3x$ and $f'(x) =
3x^2-8x+3$,
\begin{image}
\begin{tikzpicture}
	\begin{axis}[
            domain=-3:3,
            ymax=3,
            ymin=-3,
            %samples=100,
            axis lines =middle, xlabel=$x$, ylabel=$y$,
            every axis y label/.style={at=(current axis.above origin),anchor=south},
            every axis x label/.style={at=(current axis.right of origin),anchor=west}
          ]
          \addplot [dashed, textColor, smooth] plot coordinates {(.451,0) (.451,.631)}; %% {.451};
          \addplot [dashed, textColor, smooth] plot coordinates {(2.215,-2.113) (2.215,0)}; %% axis{2.215};
          \addplot [very thick, penColor2, smooth] {3*x^2-8*x+3};
          \addplot [very thick, penColor, smooth] {x^3-4*x^2+3*x};
          \node at (axis cs:2.5,-2) [anchor=west] {\color{penColor}$f$};  
          \node at (axis cs:.2,2) [anchor=west] {\color{penColor2}$f'$};
          \addplot[color=penColor2,fill=penColor2,only marks,mark=*] coordinates{(.451,0)};  %% closed hole
          \addplot[color=penColor2,fill=penColor2,only marks,mark=*] coordinates{(2.215,0)};  %% closed hole
          \addplot[color=penColor,fill=penColor,only marks,mark=*] coordinates{(.451,.631)};  %% closed hole
          \addplot[color=penColor,fill=penColor,only marks,mark=*] coordinates{(2.215,-2.113)};  %% closed hole
        \end{axis}
\end{tikzpicture}
%% \caption{A plot of $f(x) = x^3-4x^2+3x$ and $f'(x) = 3x^2-8x+3$.}
%% \label{figure:x^3-4x^2+3x}
\end{image}
or the derivative is undefined, as in the plot of $f(x) = x^{2/3}$ and $f'(x) = \frac{2}{3x^{1/3}}$:
\begin{image}
\begin{tikzpicture}
	\begin{axis}[
            domain=-3:3,
            ymax=2,
            ymin=-2,
            axis lines =middle, xlabel=$x$, ylabel=$y$,
            every axis y label/.style={at=(current axis.above origin),anchor=south},
            every axis x label/.style={at=(current axis.right of origin),anchor=west}
          ]
          \addplot [very thick, penColor2, samples=100, smooth,domain=(-3:-.01)] {-(2/3)*abs(x)^(-1/3)};
          \addplot [very thick, penColor2, samples=100, smooth,domain=(.01:3)] {(2/3)*abs(x)^(-1/3)};
          \addplot [very thick, penColor, smooth,domain=(-3:-.01)] {abs(x)^(2/3)};
          \addplot [very thick, penColor, smooth,domain=(.01:3)] {x^(2/3)};         
          \node at (axis cs:-2,1.7) [anchor=west] {\color{penColor}$f$};  
          \node at (axis cs:2,.7) [anchor=west] {\color{penColor2}$f'$};
        \end{axis}
\end{tikzpicture}
%% \caption{A plot of $f(x) = x^{2/3}$ and $f'(x) = \frac{2}{3x^{1/3}}$.}
%% \label{figure:x^{2/3}}
\end{image}
This brings us to our next definition.

\begin{definition}\index{critical point}
  A function has a \dfn{critical point} at $x=a$ if 
  \[
  f'(a) = 0\qquad\text{or}\qquad \text{$f'(a)$ does not exist.}
  \]
\end{definition}

\begin{warning} 
When looking for local maximum and minimum points, you are likely to
make two sorts of mistakes: 
\begin{itemize}
\item You may forget that a maximum or minimum can occur where the
  derivative does not exist, and so forget to check whether the
  derivative exists everywhere. 
\item You might assume that any place that the derivative is zero is a
  local maximum or minimum point, but this is not true, consider the
  plots of $f(x) = x^3$ and $f'(x) = 3x^2$.
\begin{image}
\begin{tikzpicture}
	\begin{axis}[
            domain=-3:3,
            ymax=3,
            ymin=-3,
            axis lines =middle, xlabel=$x$, ylabel=$y$,
            every axis y label/.style={at=(current axis.above origin),anchor=south},
            every axis x label/.style={at=(current axis.right of origin),anchor=west}
          ]
          \addplot [very thick, penColor2, smooth] {3*x^2};
          \addplot [very thick, penColor, smooth] {x^3};         
          \node at (axis cs:1,.9) [anchor=west] {\color{penColor}$f$};  
          \node at (axis cs:-.5,1) [anchor=west] {\color{penColor2}$f'$};
        \end{axis}
\end{tikzpicture}
%% \caption{A plot of $f(x) = x^3$ and $f'(x) = 3x^2$. While $f'(0)=0$,
%%   there is neither a maximum nor minimum at $(0,f(0))$.}
%% \label{figure:x^3}
\end{image}
While $f'(0)=0$, there is neither a maximum nor minimum at $(0,f(0))$.
\end{itemize}
\end{warning}



Since the derivative is zero or undefined at both local maximum and
local minimum points, we need a way to determine which, if either,
actually occurs. The most elementary approach is to test directly
whether the $y$ coordinates near the potential maximum or minimum are
above or below the $y$ coordinate at the point of interest. 

It is not always easy to compute the value of a function at a
particular point. The task is made easier by the availability of
calculators and computers, but they have their own drawbacks: they do
not always allow us to distinguish between values that are very close
together. Nevertheless, because this method is conceptually simple and
sometimes easy to perform, you should always consider it.




\begin{example}
Find all local maximum and minimum points for the function 
$f(x)=x^3-x$. 
\begin{explanation} 
Write
\[
\ddx f(x)=\answer[given]{3x^2-1}.
\] 
This is defined everywhere and is zero at $x=\pm \sqrt{3}/3$. Looking
first at $x=\sqrt{3}/3$, we see that 
\[
f(\sqrt{3}/3)=\answer[given]{-2\sqrt{3}/9}.
\] 
Now we test two points on either side of $x=\sqrt{3}/3$, making sure
that neither is farther away than the nearest critical point; since
$\sqrt{3}<3$, $\sqrt{3}/3<1$ and we can use $x=0$ and $x=1$. Since
\[
f(0)=0>-2\sqrt{3}/9\qquad\text{and}\qquad f(1)=0>-2\sqrt{3}/9,
\] 
there must be a local minimum at $x=\answer[given]{\sqrt{3}/3}$.

For $x=-\sqrt{3}/3$, we see that $f(-\sqrt{3}/3)=2\sqrt{3}/9$. This
time we can use $x=0$ and $x=-1$, and we find that $f(-1)=f(0)=0<
2\sqrt{3}/9$, so there must be a local maximum at
$x=\answer[given]{-\sqrt{3}/3}$, see the plot below:
\begin{image}
\begin{tikzpicture}
	\begin{axis}[
            domain=-2:2,
            ymax=2,
            ymin=-2,
            %samples=100,
            axis lines =middle, xlabel=$x$, ylabel=$y$,
            every axis y label/.style={at=(current axis.above origin),anchor=south},
            every axis x label/.style={at=(current axis.right of origin),anchor=west}
          ]
          \addplot [dashed, textColor, smooth] plot coordinates {(-.577,0) (-.577,.385)}; %% {.451};
          \addplot [dashed, textColor, smooth] plot coordinates {(.577,-.385) (.577,0)}; %% axis{2.215};

          \addplot [very thick, penColor2, smooth] {3*x^2-1};
          \addplot [very thick, penColor, smooth] {x^3-x};

          \node at (axis cs:1.2,.3) [anchor=west] {\color{penColor}$f$};  
          \node at (axis cs:-.75,1) [anchor=west] {\color{penColor2}$f'$};

          \addplot[color=penColor2,fill=penColor2,only marks,mark=*] coordinates{(-.577,0)};  %% closed hole
          \addplot[color=penColor2,fill=penColor2,only marks,mark=*] coordinates{(.577,0)};  %% closed hole
          \addplot[color=penColor,fill=penColor,only marks,mark=*] coordinates{(-.577,.385)};  %% closed hole
          \addplot[color=penColor,fill=penColor,only marks,mark=*] coordinates{(.577,-.385)};  %% closed hole
        \end{axis}
\end{tikzpicture}
%%\caption{A plot of $f(x) = x^3-x$ and $f'(x) = 3x^2-1$.}
%%\label{figure:x^3-x}
\end{image}
\end{explanation}
\end{example}






\section{The first derivative test}

The method of the previous section for deciding whether there is a
local maximum or minimum at a critical point by testing ``near-by''
points is not always convenient. Instead, since we have already had to
compute the derivative to find the critical points, we can use
information about the derivative to decide. Recall that
\begin{itemize}
\item If $f'(x) >0$ on an interval, then $f$ is increasing on that interval.
\item If $f'(x) <0$ on an interval, then $f$ is decreasing on that interval.
\end{itemize}

So how exactly does the derivative tell us whether there is a maximum,
minimum, or neither at a point? Use the \textit{first derivative test}.

\begin{theorem}[First Derivative Test]\index{first derivative test}\label{T:fdt}
Suppose that $f$ is continuous on an interval, and that $f'(a)=0$ for
some value of $a$ in that interval.
\begin{itemize}
\item If $f'(x)>0$ to the left of $a$ and $f'(x)<0$ to the right of
  $a$, then $f(a)$ is a local maximum.
\item If $f'(x)<0$ to the left of $a$ and $f'(x)>0$ to the right of
  $a$, then $f(a)$ is a local minimum.
\item If $f'(x)$ has the same sign to the left and right of $a$,
  then $f(a)$ is not a local extremum.
\end{itemize}
\end{theorem}

\begin{example}\label{E:localextrema}
Consider the function 
\[
f(x) = \frac{x^4}{4}+\frac{x^3}{3}-x^2
\]
Find the intervals on which $f$ is increasing and decreasing and
identify the local extrema of $f$.


\begin{explanation}
Start by computing
\[
\ddx f(x) = \answer[given]{x^3+x^2-2x}.
\]
Now we need to find when this function is positive and when it is
negative. To do this, solve 
\[
f'(x) = \answer[given]{x^3+x^2-2x} =0.
\]
Factor $f'(x)$
\begin{align*}
f'(x) &= \answer[given]{x^3+x^2-2x} \\
&=x(\answer[given]{x^2+x-2})\\
&=x(x+2)\answer[given]{(x-1)}.
\end{align*}
So the critical points (when $f'(x)=0$) are when $x=-2$, $x=0$, and
$x=1$. Now we can check points \textbf{between} the critical points to find
when $f'(x)$ is increasing and decreasing:
\begin{align*}
  f'(-3)&=\answer[given]{-12},\\
  f'(.5)&=\answer[given]{-0.625},\\
  f'(-1)&=\answer[given]{2},\\
  f'(2)&=\answer[given]{8}.
\end{align*}
From this we can make a sign table:

\begin{image}
\begin{tikzpicture}
	\begin{axis}[
            trim axis left,
            scale only axis,
            domain=-3:3,
            ymax=2,
            ymin=-2,
            axis lines=none,
            height=3cm, %% Hard coded height! 
            width=\textwidth, %% width
          ]
          %\addplot [draw=none, fill=fill1, domain=(-3:-2)] {2} \closedcycle;
          %\addplot [draw=none, fill=fill2, domain=(-2:0)] {2} \closedcycle;
          %\addplot [draw=none, fill=fill1, domain=(0:1)] {2} \closedcycle;
          %\addplot [draw=none, fill=fill2, domain=(1:3)] {2} \closedcycle;
          
          \addplot [->,textColor] plot coordinates {(-3,0) (3,0)}; %% axis{0};

          \addplot [->,ultra thick,textColor,shorten <=2pt,shorten >=2pt] plot coordinates {(-3,1.5) (-2,.5)}; %% decreasing
          \addplot [->,ultra thick,textColor,shorten <=2pt,shorten >=2pt] plot coordinates {(-2,.5) (0,1.5)}; %% increasing
          \addplot [->,ultra thick,textColor,shorten <=2pt,shorten >=2pt] plot coordinates {(0,1.5) (1,.5)}; %% decreasing
          \addplot [->,ultra thick,textColor,shorten <=2pt,shorten >=2pt] plot coordinates {(1,.5) (3,1.5)}; %% increasing
          
          \addplot [dashed, textColor] plot coordinates {(-2,0) (-2,2)};
          \addplot [dashed, textColor] plot coordinates {(0,0) (0,2)};
          \addplot [dashed, textColor] plot coordinates {(1,0) (1,2)};
          
          \node at (axis cs:-2,0) [anchor=north,textColor] {\footnotesize$-2$};
          \node at (axis cs:0,0) [anchor=north,textColor] {\footnotesize$0$};
          \node at (axis cs:1,0) [anchor=north,textColor] {\footnotesize$1$};

          \node at (axis cs:-2.5,-.7) [textColor] {\footnotesize$f'(x)<0$};
          \node at (axis cs:.5,-.7) [textColor] {\footnotesize$f'(x)<0$};
          \node at (axis cs:-1,-.7) [textColor] {\footnotesize$f'(x)>0$};
          \node at (axis cs:2,-.7) [textColor] {\footnotesize$f'(x)>0$};

          %% \node at (axis cs:-2.5,-.5) [anchor=north,textColor] {\footnotesize Decreasing};
          %% \node at (axis cs:.5,-.5) [anchor=north,textColor] {\footnotesize Decreasing};
          %% \node at (axis cs:-1,-.5) [anchor=north,textColor] {\footnotesize Increasing};
          %% \node at (axis cs:2,-.5) [anchor=north,textColor] {\footnotesize Increasing};

        \end{axis}
\end{tikzpicture}
\end{image}

Hence $f$ is increasing on $(-2,0)$ and $(1,\infty)$ and $f$ is
decreasing on $(-\infty,-2)$ and $(0,1)$. Moreover, from the first
derivative test, the local maximum is at $x=0$ while the local minima
are at $x=-2$ and $x=1$, see the graphs of $f(x) =x^4/4 + x^3/3
-x^2$ and $f'(x) = x^3 + x^2 -2x$.
\begin{image}
\begin{tikzpicture}
	\begin{axis}[
            domain=-4:4,
            ymax=5,
            ymin=-5,
            %samples=100,
            axis lines =middle, xlabel=$x$, ylabel=$y$,
            every axis y label/.style={at=(current axis.above origin),anchor=south},
            every axis x label/.style={at=(current axis.right of origin),anchor=west}
          ]
          \addplot [dashed, textColor, smooth] plot coordinates {(-2,0) (-2,-2.667)}; %% {.451};
          \addplot [dashed, textColor, smooth] plot coordinates {(1,0) (1,-.4167)}; %% axis{2.215};

          \addplot [very thick, penColor, smooth] {(x^4)/4 + (x^3)/3 -x^2};
          \addplot [very thick, penColor2, smooth] {x^3 + x^2 -2*x};

          \node at (axis cs:-1.3,-2) [anchor=west] {\color{penColor}$f$};  
          \node at (axis cs:-2.1,2) [anchor=west] {\color{penColor2}$f'$};

          \addplot[color=penColor2,fill=penColor2,only marks,mark=*] coordinates{(-2,0)};  %% closed hole
          \addplot[color=penColor2,fill=penColor2,only marks,mark=*] coordinates{(1,0)};  %% closed hole
          \addplot[color=penColor2,fill=penColor3,only marks,mark=*] coordinates{(0,0)};  %% closed hole
          \addplot[color=penColor,fill=penColor,only marks,mark=*] coordinates{(-2,.-2.667)};  %% closed hole
          \addplot[color=penColor,fill=penColor,only marks,mark=*] coordinates{(1,-.4167)};  %% closed hole
        \end{axis}
\end{tikzpicture}
\end{image}
\end{explanation}
\end{example}


Hence we have seen that if $f'$ is zero and increasing at a point,
then $f$ has a local minimum at the point. If $f'$ is zero and
decreasing at a point then $f$ has a local maximum at the
point. Thus, we see that we can gain information about $f$ by
studying how $f'$ changes. This leads us to our next section.









\end{document}
